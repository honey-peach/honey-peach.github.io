<!DOCTYPE html>
<html>
<head><meta name="generator" content="Hexo 3.9.0">
    <meta charset="utf-8">
    
    
    <title>你好！Apache | Zip的小窝</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    
    <meta name="keywords" content>
    <link rel="shortcut icon" href="/img/favicon.png">
    <link rel="stylesheet" href="//cdn.jsdelivr.net/gh/fancyapps/fancybox@3.5.2/dist/jquery.fancybox.min.css">
    <link rel="stylesheet" href="/css/style.css?v=1.4.0">
    
    <script type="text/javascript">
        // Data Center
        var DC = {
            reward:	true,
            lv: JSON.parse('{"enable":true,"app_id":"LQcg6cueG8cMcLf9gSrAhF6d-gzGzoHsz","app_key":"zAMFPgKrAh09qqQDGHvdU0Uq","icon":true}'),
            v: JSON.parse('{"enable":true,"appid":"LQcg6cueG8cMcLf9gSrAhF6d-gzGzoHsz","appkey":"zAMFPgKrAh09qqQDGHvdU0Uq","notify":false,"verify":true,"placeholder":"等一个人，还是等一个故事？\\n🍇🍈🍉🍊🍋🍌🍍🍎🍏🍐🍑🍒🍓🥝🍅","avatar":"wavatar"}'),
            g: JSON.parse('{"enable":false,"lazy":true,"owner":"ourfor","repo":"comments","oauth":{"client_id":"9b9deae708b1f154468b","client_secret":"081f266d40be3c096596315129d8594d2ef37138"},"perPage":5}'),
            d: JSON.parse('{"app_id":null}')
        };
    </script>

    <script type="text/javascript">
        window.lazyScripts=[];
    </script>
    

    <!-- 添加图片替换脚本-->
    <script>
        let ImgReplace = ()=>{
            let img = document.getElementsByTagName('img');
            for(let i =0;i<img.length;i++){
                let src = img[i].src;
                src = src.replace("//index","/index");
                img[i].src = src;
            }
            console.log("执行ImgReplace")
        }

        window.onload=ImgReplace;
        
        
    </script>
</head>


<body>
    <div id="loading" class="active"></div>

    <aside id="menu" class="hide" >
  <div class="inner flex-row-vertical">
    <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="menu-off">
        <i class="icon icon-lg icon-close"></i>
    </a>
    <div class="brand-wrap">
      
      <img src="/img/brand.jpg" class="brand-bg">
      
      <div class="brand">
        <a href="/" class="avatar waves-effect waves-circle waves-light">
          <img src="/img/sagit.jpg">
        </a>
        <hgroup class="introduce">
          <h5 class="nickname">Zip</h5>
          <a href="mailto:世纪末的无聊消遣" title="世纪末的无聊消遣" class="mail">
            
              <span>世</span>
            
              <span>纪</span>
            
              <span>末</span>
            
              <span>的</span>
            
              <span>无</span>
            
              <span>聊</span>
            
              <span>消</span>
            
              <span>遣</span>
            
          </a>
        </hgroup>
        
        <ul class="menu-link">
          
              <li>
                <a href="https://github.com/ourfor" target="_blank">
                  <i class="icon icon-lg icon-github"></i>
                </a>
              </li>
            
              <li>
                <a href="https://weibo.com/u/5213768713?refer_flag=1001030201_&amp;is_all=1" target="_blank">
                  <i class="icon icon-lg icon-weibo"></i>
                </a>
              </li>
            
              <li>
                <a href="https://www.youtube.com/channel/UC82vnpLsmIiiTYQD7wRcWwQ?view_as=subscriber" target="_blank">
                  <i class="icon icon-lg icon-youtube"></i>
                </a>
              </li>
            
              <li>
                <a href="https://www.instagram.com/sagit.zxw/" target="_blank">
                  <i class="icon icon-lg icon-instagram"></i>
                </a>
              </li>
            
              <li>
                <a href="https://plus.google.com/110846201925313557708" target="_blank">
                  <i class="icon icon-lg icon-google-plus-square"></i>
                </a>
              </li>
            
        </ul>
        
      </div>
    </div>
    <div class="scroll-wrap flex-col">
      <ul class="nav">
        
            <li class="">
              <a href="/"  >
                <i class="icon icon-lg icon-home"></i>
                HOME
              </a>
            </li>
        
            <li class="">
              <a href="/tags"  >
                <i class="icon icon-lg icon-tags"></i>
                TAGS
              </a>
            </li>
        
            <li class="">
              <a href="/archives"  >
                <i class="icon icon-lg icon-archives"></i>
                ARCHIVES
              </a>
            </li>
        
            <li class="">
              <a href="/about"  >
                <i class="icon icon-lg icon-address-book"></i>
                ABOUT
              </a>
            </li>
        
            <li class="">
              <a href="/books"  >
                <i class="icon icon-lg icon-bookmark"></i>
                BOOK
              </a>
            </li>
        
            <li class="">
              <a href="/movies"  >
                <i class="icon icon-lg icon-video-camera"></i>
                MOVIE
              </a>
            </li>
        
            <li class="">
              <a href="/games"  >
                <i class="icon icon-lg icon-gamepad"></i>
                GAME
              </a>
            </li>
        
            <li class="">
              <a href="https://github.com/ourfor" target="_blank" >
                <i class="icon icon-lg icon-github-alt"></i>
                GITHUB
              </a>
            </li>
        
            <li class="">
              <a href="https://play.ourfor.top"  >
                <i class="icon icon-lg icon-random"></i>
                MUSIC
              </a>
            </li>
        
            <li class="">
              <a href="/links"  >
                <i class="icon icon-lg icon-external-link-square"></i>
                LINKS
              </a>
            </li>
        
      </ul>
    </div>
  </div>
</aside>

    <main id="main">
        <header class="top-header" id="header">
    <div class="flex-row clearfix">
        <a href="javascript:;" class="header-icon pull-left waves-effect waves-circle waves-light on" id="menu-toggle">
          <i class="icon icon-lg icon-navicon"></i>
        </a>
        <div class="flex-col header-title ellipsis">
            <span>你好！Apache</span>
            
        </div>
        
        <a href="javascript:;" id="site_search_btn" class="header-icon pull-right waves-effect waves-circle waves-light">
            <i class="icon icon-lg icon-search"></i>
        </a>
        
    </div>
</header>
<header class="content-header post-header">
    <img src="/img/headerBg.jpg" class="header-bg">
    <div class="container fade-scale">
        <h1 class="title">你好！Apache</h1>
        <h5 class="subtitle">
            
                <time datetime="2019-04-30T10:46:52.000Z" itemprop="datePublished" class="page-time">
  2019-04-30
</time>


            
        </h5>
        
    </div>
    


</header>

<div id="site_search">
    <div class="search-title clearfix">
        <span class="pull-left">
          <i class="icon icon-lg icon-search"></i>
        </span>
        <input type="text" id="local-search-input" name="q" results="0" placeholder="search my blog..." class="form-control pull-left"/>
        <a href="javascript:;" class="close pull-right waves-effect waves-circle waves-light">
          <i class="icon icon-lg icon-close"></i>
        </a>
    </div>
    <div id="local-search-result"></div>
</div>


<div class="container body-wrap">
    <article id="post-apache_start"
    class="post-article article-type-post" itemprop="blogPost">
      <div class="post-card">
          <h1 class="post-card-title">你好！Apache</h1>
          <div class="post-meta">
              <time class="post-time" title="2019-04-30 10:46:52" datetime="2019-04-30T10:46:52.000Z"  itemprop="datePublished">2019-04-30</time>

              


              
	<span id="/2019/04/30/apache_start/" class="leancloud_visitors" data-flag-title="你好！Apache" title="你好！Apache">
		
			<i class="icon icon-eye"></i>
		
		<span class="leancloud-visitors-count"></span>
	</span>
 

              
    <span class="leancloud-comment">
        <i class="icon icon-comment-o"></i>
        <a href="/2019/04/30/apache_start/#comment">
            <span class="valine-comment-count" data-xid="/2019/04/30/apache_start/"></span>
        </a>
    </span>



              
          </div>
          <div class="post-content" id="post-content" itemprop="postContent">
              
              <div style="text-align:center"><br>也许放弃 才能靠近你 不再见你<br>你才会把我记起 时间累积<br>这盛夏的果实 回忆里爱情的香气<br>我以为不露痕迹 思念却满溢<br>或许这代表了我的心<br>不要刻意说 你还爱我<br></div>

<p style="float:right">&lt;盛夏的果实&gt; –莫文蔚</p>

<a id="more"></a>
<p>Apache<a href="http://www.apache.org/" target="_blank" rel="noopener">官网</a></p>
<figure class="image-box">
                <a rel=你好！Apache href="http://www.apache.org/img/support-apache.jpg" title="" data-fancybox="images"><img src="http://www.apache.org/img/support-apache.jpg" alt title class></a>
                <p></p>
            </figure>
<p>为什么更换为Apache的服务端软件?</p>
<blockquote>
<p>主要原因有以下几点:</p>
</blockquote>
<ul>
<li>随着学习的不断的深入，不断能感受到Apache基金会的牛逼过人之处，以及微软，所以数据库软件我也由原本的mysql换成了sql server，不得不说大企业的软件就是好用👌</li>
<li>caddy只适合一些轻量级的网站，性能捉急</li>
<li>稳定是排在第一位的</li>
</ul>
<p>主要想要做到以下几点:</p>
<ul>
<li>全站ssl加密，即<code>https</code></li>
<li><code>代理</code> 设置比较方便，配置文件比较好设置</li>
<li><code>目录浏览</code>这个我打算自己写一个好的</li>
</ul>
<hr>
<p>由于刚接触很久没有接触<code>Apache</code>，我打算在虚拟机上面熟悉以后再搬到生产环境上面去。接下来的笔记将会从以下几个方面来记录:</p>
<ul>
<li><code>Apache</code>安装包括编译安装</li>
<li><code>Apache</code>配置文件位置，熟悉配置文件</li>
<li>对服务器的优化设置</li>
</ul>
<hr>
<p>macOS下面，<code>httpd.conf</code>里面设置<code>User</code>为自己系统里面的用户名,可以解决没有搜索权限</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">Listen 80</span><br><span class="line">&lt;VirtualHost *:80&gt;</span><br><span class="line">    DocumentRoot    /Users/sagit/Documents/wwwroot/Blog/public</span><br><span class="line">    ServerName  blog.ourfor.com</span><br><span class="line">    &lt;Directory <span class="string">"/Users/sagit/Documents/wwwroot/Blog/public"</span>&gt;</span><br><span class="line">        Options FollowSymLinks</span><br><span class="line">        AllowOverride   None</span><br><span class="line">        Order   allow,deny</span><br><span class="line">        Require all granted</span><br><span class="line">        Allow from all</span><br><span class="line">    &lt;/Directory&gt;</span><br><span class="line">    ErrorLog <span class="string">"/usr/local/var/log/httpd/blog.ourfor.com.com-error_log"</span></span><br><span class="line">&lt;/VirtualHost&gt;</span><br></pre></td></tr></table></figure>
<hr>
<p>如果页面提示禁止没有权限，那么不要忘了<code>&lt;Directory&gt;</code>里面的内容：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;Directory <span class="string">"/Users/sagit/Documents/wwwroot/Blog/public"</span>&gt;</span><br><span class="line">        Options FollowSymLinks</span><br><span class="line">        AllowOverride   None</span><br><span class="line">        Order   allow,deny</span><br><span class="line">        Require all granted</span><br><span class="line">        Allow from all</span><br><span class="line">    &lt;/Directory&gt;</span><br></pre></td></tr></table></figure></p>
<hr>
<p>macOS编辑<code>mod_jk</code>,安装好<code>httpd</code> -<code>apache</code><br>编译命令：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">./configure CFLAGS=<span class="string">'-arch x86_64'</span> APXSLDFLAGS=<span class="string">'-arch x86_64'</span> --with-apxs=/usr/<span class="built_in">local</span>/bin/apxs</span><br><span class="line">make</span><br></pre></td></tr></table></figure></p>
<h2 id="有些脚本是在window下面写的，在unix上面有些不可见字符，可以用vi打开后设置fileformat，即-set-fileformat-unix或者-set-ff-unix"><a href="#有些脚本是在window下面写的，在unix上面有些不可见字符，可以用vi打开后设置fileformat，即-set-fileformat-unix或者-set-ff-unix" class="headerlink" title="有些脚本是在window下面写的，在unix上面有些不可见字符，可以用vi打开后设置fileformat，即:set fileformat=unix或者:set ff=unix"></a>有些脚本是在window下面写的，在unix上面有些不可见字符，可以用vi打开后设置<code>fileformat</code>，即<code>:set fileformat=unix</code>或者<code>:set ff=unix</code></h2><h1 id="apache-httpd服务器连接tomcat"><a href="#apache-httpd服务器连接tomcat" class="headerlink" title="apache httpd服务器连接tomcat"></a><code>apache httpd</code>服务器连接<code>tomcat</code></h1><blockquote>
<p>演示系统环境<code>macOS Majave 10.14.4</code></p>
</blockquote>
<ul>
<li>加载<code>mod_jk</code>模块,我已经编译好了<a href="https://raw.github.com/ourfor/Blog/master/tomcat/mod_jk/mod_jk.so" target="_blank" rel="noopener">最新的</a>,适用于Apache版本<code>Server version: Apache/2.4.39 (Unix)</code></li>
</ul>
<p>在<code>httpd</code>的配置文件中添加一个名为<code>httpd-jk.conf</code>(名字可以随便取)，同时在<code>httpd.conf</code>里面导入这个配置文件:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Virtual hosts</span></span><br><span class="line">Include /usr/<span class="built_in">local</span>/etc/httpd/extra/httpd-vhosts.conf</span><br></pre></td></tr></table></figure></p>
<p>顺便把<code>User</code>改成你的登录用户名,原本为<code>_www</code><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">User sagit</span><br><span class="line">Group _www</span><br></pre></td></tr></table></figure></p>
<p>这样的话网站更目录就不需要放在默认的位置了</p>
<ul>
<li>配置<code>httpd-jk.conf</code>文件，该文件负责导入<code>mod_jk</code>，将下载好的<code>mod_jk.so</code>文件放到httpd的模块文件夹里面，然后编辑<code>httpd-jk.conf</code>文件:</li>
</ul>
<p><a href="https://github.com/ourfor/Blog/blob/d8b3eb027971e15ce854055dc1348de2367009be/tomcat/mod_jk/httpd-jk.conf#L22-L123" target="_blank" rel="noopener">https://github.com/ourfor/Blog/blob/d8b3eb027971e15ce854055dc1348de2367009be/tomcat/mod_jk/httpd-jk.conf#L22-L123</a></p>
<p>主要注意下面几个位置<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">LoadModule jk_module lib/httpd/modules/mod_jk.so</span><br><span class="line">&lt;IfModule jk_module&gt;</span><br><span class="line">    <span class="comment"># and in the global server</span></span><br><span class="line">    JkWorkersFile /usr/<span class="built_in">local</span>/etc/httpd/extra/workers.properties</span><br><span class="line"></span><br><span class="line">    <span class="comment"># Our JK error log</span></span><br><span class="line">    <span class="comment"># You can (and should) use rotatelogs here</span></span><br><span class="line">    JkLogFile /usr/<span class="built_in">local</span>/var/<span class="built_in">log</span>/httpd/mod_jk.log</span><br><span class="line"></span><br><span class="line">    <span class="comment"># Our JK shared memory file</span></span><br><span class="line">    JkShmFile /usr/<span class="built_in">local</span>/var/<span class="built_in">log</span>/httpd//mod_jk.shm</span><br></pre></td></tr></table></figure></p>
<p>加载<code>mod_jk</code>的路径，这里的路径跟随<code>httpd.conf</code>里面写，因为这个文件会被原封不动的include到<code>httpd.conf</code>里面，只需要修改一下最后的模块文件名，即<code>mod_jk.so</code><br>接下来这个<code>JkWorkersFile</code>指明<code>workers.properties</code>的位置，这个<code>worker.properties</code>文件最好放在和<code>httpd-jk.conf</code>同一目录下面，并且按照<code>httpd.conf</code>里面导入额外的配置文件的父路径一致，<code>JkLogFile</code>和<code>JkShmFile</code>这两个文件的父路径和<code>httpd.conf</code>里面存放日志文件的父路径一致</p>
<ul>
<li><code>workers.properties</code>里面写什么<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">worker.list=jk-manager,tomcatA</span><br><span class="line">worker.jk-manager.type=status</span><br><span class="line"></span><br><span class="line">worker.tomcatA.type=ajp13</span><br><span class="line">worker.tomcatA.host=localhost</span><br><span class="line">worker.tomcatA.port=8009</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p>主要注意<code>worker.list</code>,这里面写了几个东西，下面就要配置几个</p>
<ul>
<li>接下来是tomcat的<code>server.xml</code>文件</li>
</ul>
<p><a href="https://github.com/ourfor/Blog/blob/d8b3eb027971e15ce854055dc1348de2367009be/tomcat/mod_jk/server.xml#L128-L133" target="_blank" rel="noopener">https://github.com/ourfor/Blog/blob/d8b3eb027971e15ce854055dc1348de2367009be/tomcat/mod_jk/server.xml#L128-L133</a></p>
<ul>
<li>Apache里面配置虚拟主机就行了<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&lt;VirtualHost *:80&gt;</span><br><span class="line">	DocumentRoot	/usr/local/Cellar/tomcat/9.0.17/libexec/webapps/lab_war_exploded </span><br><span class="line">	ServerName file.ourfor.com</span><br><span class="line">	JkMount /* tomcatA</span><br><span class="line">	DirectoryIndex index.html index.jsp</span><br><span class="line">	&lt;Directory &quot;/usr/local/Cellar/tomcat/9.0.17/libexec/webapps/lab_war_exploded&quot;&gt;</span><br><span class="line">		Options FollowSymLinks</span><br><span class="line">		AllowOverride	None</span><br><span class="line">		Order	allow,deny</span><br><span class="line">		Allow from all</span><br><span class="line">	&lt;/Directory&gt;</span><br><span class="line">&lt;/VirtualHost&gt;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h2 id="其中jkMount是匹配规则，匹配到什么路径才交给tomcat处理，以及交给谁处理"><a href="#其中jkMount是匹配规则，匹配到什么路径才交给tomcat处理，以及交给谁处理" class="headerlink" title="其中jkMount是匹配规则，匹配到什么路径才交给tomcat处理，以及交给谁处理"></a>其中<code>jkMount</code>是匹配规则，匹配到什么路径才交给<code>tomcat</code>处理，以及交给谁处理</h2><p>如果需要在一个服务器上面部署配置多个tomcat的<code>webapp</code>的话，只需要在<code>httpd-vhosts.conf</code>和<code>server.xml</code>里面添加就可以了.</p>
<blockquote>
<p>server.xml</p>
</blockquote>
<p><a href="https://github.com/ourfor/Blog/blob/e1a974fe623816814c20f87acdd51aefa0234494/tomcat/mod_jk/server.xml#L128-L140" target="_blank" rel="noopener">https://github.com/ourfor/Blog/blob/e1a974fe623816814c20f87acdd51aefa0234494/tomcat/mod_jk/server.xml#L128-L140</a></p>
<blockquote>
<p>httpd-vhosts.conf</p>
</blockquote>
<h2 id="https-github-com-ourfor-Blog-blob-e1a974fe623816814c20f87acdd51aefa0234494-tomcat-mod-jk-httpd-vhosts-conf-L37-L61"><a href="#https-github-com-ourfor-Blog-blob-e1a974fe623816814c20f87acdd51aefa0234494-tomcat-mod-jk-httpd-vhosts-conf-L37-L61" class="headerlink" title="https://github.com/ourfor/Blog/blob/e1a974fe623816814c20f87acdd51aefa0234494/tomcat/mod_jk/httpd-vhosts.conf#L37-L61"></a><a href="https://github.com/ourfor/Blog/blob/e1a974fe623816814c20f87acdd51aefa0234494/tomcat/mod_jk/httpd-vhosts.conf#L37-L61" target="_blank" rel="noopener">https://github.com/ourfor/Blog/blob/e1a974fe623816814c20f87acdd51aefa0234494/tomcat/mod_jk/httpd-vhosts.conf#L37-L61</a></h2><p>如果使用<code>idea</code>开发的话，这里<code>server.xml</code>里面的<code>docBase</code>也写成绝对路径，或者将<code>appbase</code>写成绝对路径,二选一<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">Engine</span> <span class="attr">name</span>=<span class="string">"Catalina"</span> <span class="attr">defaultHost</span>=<span class="string">"localhost"</span> <span class="attr">jvmRoute</span>=<span class="string">"tomcatA"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">Host</span> <span class="attr">name</span>=<span class="string">"file.ourfor.com"</span> <span class="attr">appBase</span>=<span class="string">"/Users/sagit/Desktop/www"</span></span></span><br><span class="line"><span class="tag">                <span class="attr">unpackWARs</span>=<span class="string">"true"</span> <span class="attr">autoDeploy</span>=<span class="string">"true"</span></span></span><br><span class="line"><span class="tag">                <span class="attr">xmlValidation</span>=<span class="string">"false"</span> <span class="attr">xmlNamespaceAware</span>=<span class="string">"false"</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">Context</span> <span class="attr">path</span>=<span class="string">""</span> <span class="attr">docBase</span>=<span class="string">"lab_war_exploded"</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">Host</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">Host</span> <span class="attr">name</span>=<span class="string">"doc.ourfor.com"</span> <span class="attr">appBase</span>=<span class="string">"webapps"</span></span></span><br><span class="line"><span class="tag">                <span class="attr">unpackWARs</span>=<span class="string">"true"</span> <span class="attr">autoDeploy</span>=<span class="string">"true"</span></span></span><br><span class="line"><span class="tag">                <span class="attr">xmlValidation</span>=<span class="string">"false"</span> <span class="attr">xmlNamespaceAware</span>=<span class="string">"false"</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">Context</span> <span class="attr">path</span>=<span class="string">""</span> <span class="attr">docBase</span>=<span class="string">"/Users/sagit/Desktop/www/demo"</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">Host</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
<hr>
<h3 id="通过jk连接器，web应用程序的数据源找不到"><a href="#通过jk连接器，web应用程序的数据源找不到" class="headerlink" title="通过jk连接器，web应用程序的数据源找不到"></a>通过jk连接器，web应用程序的数据源找不到</h3><p>可以考虑将数据源配置到tomcat的<code>server.xml</code>里面，但是我更推荐下面这种:</p>
<p>在web程序的<code>web.xml</code>里面添加:</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">resource-ref</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">res-ref-name</span>&gt;</span>jdbc/shop<span class="tag">&lt;/<span class="name">res-ref-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">res-type</span>&gt;</span>javax.sql.DataSource<span class="tag">&lt;/<span class="name">res-type</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">res-auth</span>&gt;</span>Container<span class="tag">&lt;/<span class="name">res-auth</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">resource-ref</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>然后将<code>context.xml</code>复制为<code>$CATALINA_BASE/conf/[enginename]/[hostname]/context.xml.default</code></p>
<p>具体原因查看<a href="https://tomcat.apache.org/tomcat-9.0-doc/config/context.html" target="_blank" rel="noopener">官方文档</a></p>
<blockquote>
<p>When autoDeploy or deployOnStartup operations are performed by a Host, the name and context path of the web application are derived from the name(s) of the file(s) that define(s) the web application. Consequently, the context path may not be defined in a META-INF/context.xml embedded in the application and there is a close relationship between the context name, context path, context version and the base file name (the name minus any .war or .xml extension) of the file.</p>
</blockquote>
<blockquote>
<p>If no version is specified then the context name is always the same as the context path. If the context path is the empty string then the base name will be ROOT (always in upper case) otherwise the base name will be the context path with the leading ‘/‘ removed and any remaining ‘/‘ characters replaced with ‘#’.</p>
</blockquote>
<blockquote>
<p> If a version is specified then the context path remains unchanged and both the context name and the base name have the string ‘##’ appended to them followed by the version identifier.<br>Some examples of these naming conventions are given below.</p>
</blockquote>
<h2 id="一些网友的解决方案"><a href="#一些网友的解决方案" class="headerlink" title="一些网友的解决方案"></a>一些网友的<a href="https://stackoverflow.com/questions/50482786/javax-naming-namenotfoundexception-name-jdbc-rhwebdb-is-not-bound-in-this-con" target="_blank" rel="noopener">解决方案</a></h2>
          </div>
          
<blockquote class="post-copyright" style="border-left: 3px solid #ff1700;">
    <div class="content">
        
<span class="post-time">
    Last updated: <time datetime="2019-07-19T05:52:57.060Z" itemprop="dateUpdated">2019-07-19 05:52:57</time>
</span><br>


        <p style="margin:unset"><strong>本文作者: </strong><a href="https://ourfor.top">ourfor</a></p>
        <p style="margin:unset"><strong>版权声明: </strong> 本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> 许可协议。</p>
        
        <strong>转载注明出处：</strong><a href="/2019/04/30/apache_start/" target="_blank" rel="external">https://blog.ourfor.top/2019/04/30/apache_start/</a>
        
    </div>
    <footer>
        <a href="https://blog.ourfor.top">
            <img src="/img/sagit.jpg" alt="Zip">
            Zip
        </a>
    </footer>
</blockquote>

          
              <div class="page-reward">
    <a id="rewardBtn" href="javascript:;" class="page-reward-btn waves-effect waves-circle waves-light">赏</a>
</div>

              
          
          <div class="post-footer">
              
              <div class="page-share-wrap">
    

<div class="page-share" id="pageShare">
    <ul class="reset share-icons">
      
      <li>
        <a class="weibo share-sns" target="_blank" href="http://service.weibo.com/share/share.php?url=https://blog.ourfor.top/2019/04/30/apache_start/&title=《你好！Apache》 — Zip的小窝&pic=https://blog.ourfor.top/img/sagit.jpg" data-title="微博">
          <i class="icon icon-weibo"></i>
        </a>
      </li>
      
      <li>
        <a class="weixin share-sns wxFab" href="javascript:;" data-title="微信">
          <i class="icon icon-weixin"></i>
        </a>
      </li>
      
      <li>
        <a class="qq share-sns" target="_blank" href="http://connect.qq.com/widget/shareqq/index.html?url=https://blog.ourfor.top/2019/04/30/apache_start/&title=《你好！Apache》 — Zip的小窝&source=也许放弃 才能靠近你 不再见你你才会把我记起 时间累积这盛夏的果实 回忆里爱情的香气我以为不露痕迹 思念却满溢或许这代表了我的心不要刻意说 你还爱我

&..." data-title=" QQ">
          <i class="icon icon-qq"></i>
        </a>
      </li>
      
      <li>
        <a class="facebook share-sns" target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=https://blog.ourfor.top/2019/04/30/apache_start/" data-title=" Facebook">
          <i class="icon icon-facebook"></i>
        </a>
      </li>
      
      <li>
        <a class="twitter share-sns" target="_blank" href="https://twitter.com/intent/tweet?text=《你好！Apache》 — Zip的小窝&url=https://blog.ourfor.top/2019/04/30/apache_start/&via=https://blog.ourfor.top" data-title=" Twitter">
          <i class="icon icon-twitter"></i>
        </a>
      </li>
      
      <li>
        <a class="google share-sns" target="_blank" href="https://plus.google.com/share?url=https://blog.ourfor.top/2019/04/30/apache_start/" data-title=" Google+">
          <i class="icon icon-google-plus"></i>
        </a>
      </li>
      
    </ul>
 </div>



    <a href="javascript:;" id="shareFab" class="page-share-fab waves-effect waves-circle">
        <i class="icon icon-share-alt icon-lg"></i>
    </a>
</div>

          </div>
          
              
    <div id="comment"></div>



          
      </div>
      
<nav class="post-nav flex-row flex-justify-between">
  
    <div class="prev">
      <a href="/2019/05/26/本就该如此/" id="post-prev" class="post-nav-link">
        <div class="tips"><i class="icon icon-angle-left icon-lg icon-pr"></i> Prev</div>
        <h4 class="title">本就该如此</h4>
      </a>
    </div>
  

  
    <div class="next">
      <a href="/2019/04/18/kakegurui/" id="post-next" class="post-nav-link">
        <div class="tips">Next <i class="icon icon-angle-right icon-lg icon-pl"></i></div>
        <h4 class="title">狂赌之渊</h4>
      </a>
    </div>
  
</nav>


      
          <div id="repo">
    <div class="loading active"></div>
    <div class="top clearfix">
        <div class="avatar pull-left"></div>
        <div class="content pull-left">
            <p class="name"></p>
            <p class="description"></p>
        </div>
    </div>
    <ul class="bottom">
        <li class="star">
            <span class="icon icon-star"></span>
            <span class="val">0</span>
        </li>
        <li class="fork">
            <span class="icon icon-code-fork"></span>
            <span class="val">0</span>
        </li>
        <li class="date">
            <span class="icon icon-clock-o"></span>
            <span class="val">0000-00-00</span>
        </li>
    </ul>
    <a class="link" href=""></a>
</div>
      
      
        <aside class="post-widget">
            <nav class="post-toc-wrap" id="post-toc">
                <strong>目录</strong>
                <ol class="post-toc"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#有些脚本是在window下面写的，在unix上面有些不可见字符，可以用vi打开后设置fileformat，即-set-fileformat-unix或者-set-ff-unix"><span class="post-toc-number">1.</span> <span class="post-toc-text">有些脚本是在window下面写的，在unix上面有些不可见字符，可以用vi打开后设置fileformat，即:set fileformat=unix或者:set ff=unix</span></a></li></ol></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#apache-httpd服务器连接tomcat"><span class="post-toc-number"></span> <span class="post-toc-text">apache httpd服务器连接tomcat</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#其中jkMount是匹配规则，匹配到什么路径才交给tomcat处理，以及交给谁处理"><span class="post-toc-number">1.</span> <span class="post-toc-text">其中jkMount是匹配规则，匹配到什么路径才交给tomcat处理，以及交给谁处理</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#https-github-com-ourfor-Blog-blob-e1a974fe623816814c20f87acdd51aefa0234494-tomcat-mod-jk-httpd-vhosts-conf-L37-L61"><span class="post-toc-number">2.</span> <span class="post-toc-text">https://github.com/ourfor/Blog/blob/e1a974fe623816814c20f87acdd51aefa0234494/tomcat/mod_jk/httpd-vhosts.conf#L37-L61</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#通过jk连接器，web应用程序的数据源找不到"><span class="post-toc-number">2.1.</span> <span class="post-toc-text">通过jk连接器，web应用程序的数据源找不到</span></a></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#一些网友的解决方案"><span class="post-toc-number">3.</span> <span class="post-toc-text">一些网友的解决方案</span></a></li></ol>
            </nav>
            <div class="toc-bar"><div>
        </aside>
    

  </article>
  
      <div id="reward" class="page-modal reward-lay">
    <a class="close" href="javascript:;"><i class="icon icon-close"></i></a>
    <h3 class="reward-title">
        <i class="icon icon-quote-left"></i>
        给作者加个鸡腿🍗?
        <i class="icon icon-quote-right"></i>
    </h3>
    <div class="reward-content">
        
        <div class="reward-code">
            <img id="rewardCode" src="/img/wechat_pay.png" alt="打赏二维码">
        </div>
        
        <label class="reward-toggle">
            <input id="rewardToggle" type="checkbox" class="reward-toggle-check"
                data-wechat="/img/wechat_pay.png" data-alipay="/img/alipay.png">
            <div class="reward-toggle-ctrol">
                <span class="reward-toggle-item wechat">微信</span>
                <span class="reward-toggle-label"></span>
                <span class="reward-toggle-item alipay">支付宝</span>
            </div>
        </label>
        
    </div>
</div>

      
  
</div>

        <footer class="footer">
    
    

        
    <div class="bottom">
            <p>
            
            

            <span>
                Zip &copy; 2015 - 2019
            </span>

            

            
            <p>
            <span id="timeDate">载入天数...</span><span id="times">载入时分秒...</span>
        </p>
    

        <script>
        var now = new Date();
        function createtime() {
            var grt= new Date("08/13/2016 00:00:00");
            now.setTime(now.getTime()+250);
            days = (now - grt ) / 1000 / 60 / 60 / 24; dnum = Math.floor(days);
            hours = (now - grt ) / 1000 / 60 / 60 - (24 * dnum); hnum = Math.floor(hours);
           if(String(hnum).length ==1 ){hnum = "0" + hnum;} minutes = (now - grt ) / 1000 /60 - (24 * 60 * dnum) - (60 * hnum);
           mnum = Math.floor(minutes); if(String(mnum).length ==1 ){mnum = "0" + mnum;}
           seconds = (now - grt ) / 1000 - (24 * 60 * 60 * dnum) - (60 * 60 * hnum) - (60 * mnum);
           snum = Math.round(seconds); if(String(snum).length ==1 ){snum = "0" + snum;}
           document.getElementById("timeDate").innerHTML = "本站已安全运行 "+dnum+" 天 ";
           document.getElementById("times").innerHTML = hnum + " 小时 " + mnum + " 分 " + snum + " 秒 ";
        }
    setInterval("createtime()",250);
   </script>

    </div>
</footer>

    </main>
    <div class="mask" id="mask"></div>
<a href="javascript:;" id="gotop" class="waves-effect waves-circle waves-light"><span class="icon icon-lg icon-chevron-up"></span></a>



<div class="global-share" id="globalShare">
    <ul class="reset share-icons">
      
      <li>
        <a class="weibo share-sns" target="_blank" href="http://service.weibo.com/share/share.php?url=https://blog.ourfor.top/2019/04/30/apache_start/&title=《你好！Apache》 — Zip的小窝&pic=https://blog.ourfor.top/img/sagit.jpg" data-title="微博">
          <i class="icon icon-weibo"></i>
        </a>
      </li>
      
      <li>
        <a class="weixin share-sns wxFab" href="javascript:;" data-title="微信">
          <i class="icon icon-weixin"></i>
        </a>
      </li>
      
      <li>
        <a class="qq share-sns" target="_blank" href="http://connect.qq.com/widget/shareqq/index.html?url=https://blog.ourfor.top/2019/04/30/apache_start/&title=《你好！Apache》 — Zip的小窝&source=也许放弃 才能靠近你 不再见你你才会把我记起 时间累积这盛夏的果实 回忆里爱情的香气我以为不露痕迹 思念却满溢或许这代表了我的心不要刻意说 你还爱我

&..." data-title=" QQ">
          <i class="icon icon-qq"></i>
        </a>
      </li>
      
      <li>
        <a class="facebook share-sns" target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=https://blog.ourfor.top/2019/04/30/apache_start/" data-title=" Facebook">
          <i class="icon icon-facebook"></i>
        </a>
      </li>
      
      <li>
        <a class="twitter share-sns" target="_blank" href="https://twitter.com/intent/tweet?text=《你好！Apache》 — Zip的小窝&url=https://blog.ourfor.top/2019/04/30/apache_start/&via=https://blog.ourfor.top" data-title=" Twitter">
          <i class="icon icon-twitter"></i>
        </a>
      </li>
      
      <li>
        <a class="google share-sns" target="_blank" href="https://plus.google.com/share?url=https://blog.ourfor.top/2019/04/30/apache_start/" data-title=" Google+">
          <i class="icon icon-google-plus"></i>
        </a>
      </li>
      
    </ul>
 </div>


<div class="page-modal wx-share" id="wxShare">
    <a class="close" href="javascript:;"><i class="icon icon-close"></i></a>
    <p>扫一扫，分享到微信</p>
    <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAMYAAADGCAAAAACs8KCBAAACLElEQVR42u3aSXLEIBAEQP//0/IHLKkKNI4RJKcJLxqSQ4tefn7idVyu679Pntz+1+DCwMB4LSPZYrLp9lvOnnz225vjw8DA2ICRhMIEMAO+Jt08BwMDA+Nyu23Q/MTxYWBgYLSXvxz/Fe8NDAyMlzDyAHr9lXkBLv/8cC6OgYHxQkZedf//zx/pb2BgYLyKcZSrvfDl4fKYWBgYGGsz5huQY5e8+YCLgYGxD2OsrJ9jxtLO6yfXcxwYGBgvZyRhcQzc8tor6c17AwMDYzlGu4l5fDvSMVh6w8DAWI4xs6GiKBa3P5NW6CkSAwNjIUaSXrYXvsHzC3j12WNgYCzEaK9oecKZHMF8oMfAwNiB8eyQxCem1W6ukhgYGJsx2hDZXhPzlLUIvhgYGEszxkpp+chX0gxoE+apyTUMDIwlGG1z8am+xFiz8/TtgYGBsRAjKZAlPx9rQyaFvCLHxcDAWJTRbqgNymMHkR8BBgbGPow8ILaPywfC5g8UAwNjbcZg7lueTdsoTQLxH7k4BgbG0oy2KN82DMYaDHngxsDA2I2RD0OMjVmMjYvdDIVgYGAsyjjKNTPC1TZBi2IcBgbG0oz5/mCb+s43OOvaIQYGxhKM+YLXs8MT+YgYBgbGboyZ4a22bTDzBnigv4GBgbElI29zttQiccXAwMAIAm4+hDEToD9+NcTAwPhiRpLE5oWzPFC2VAwMjD0ZbeqYpKPJ1sfGMqYamRgYGO9j/AJ2rdE/pXtRLwAAAABJRU5ErkJggg==" alt="微信分享二维码">
</div>


     
 <canvas class="fireworks" style="position: fixed;left: 0;top: 0;z-index: 1; pointer-events: none;" ></canvas> 
 <script type="text/javascript" src="//cdn.bootcss.com/animejs/2.2.0/anime.min.js"></script> 
 <script type="text/javascript" src="/js/fireworks.js"></script>
   
    <!-- main-js -->
<script type="text/javascript" src="//cdn.bootcss.com/jquery/2.1.0/jquery.min.js"></script>
<script type="text/javascript" src="/js/plugins/fastclick.js?v=1.4.0"></script>
<script type="text/javascript" src="/js/plugins/ios-orientationchange-fix.js?v=1.4.0"></script>
<script type="text/javascript" src="https://cdn.jsdelivr.net/gh/fancyapps/fancybox@3.5.2/dist/jquery.fancybox.min.js"></script>

<script type="text/javascript" src="//cdn.bootcss.com/node-waves/0.7.4/waves.min.js"></script>

<script type="text/javascript" src="/js/method.js?v=1.4.0"></script>
<script type="text/javascript" src="/js/blog.js?v=1.4.0"></script>

<!-- third-party -->


    <script type="text/javascript">
    (function() {

        const origin = "ourfor | Blog"
        let user, repo;
        origin.replace(/(\S+)\s{0,1}\|\s{0,1}(\S+)/g, (...rest) => {
            [user, repo] = [ rest[1], rest[2] ];
        });
        if (user && repo) {
            const url = `//api.github.com/repos/${user}/${repo}?callback=?`;
            $.getJSON(url, (data) => {
                updateRepoInPage(data.data);
            });
        }

        function updateRepoInPage(data) {
            const {name, description, html_url: url, stargazers_count: stars, forks, owner: owner, updated_at: update} = data;
            _loadAvatar(owner.avatar_url).then(avatarUrl => {
                const avatarBg = `url(${avatarUrl})`;
                const container = $('#repo');
                container.click(() => {
                    window.open(url);
                });

                //init
                const loadingItem = container.find('.loading').hide();
                const topItem = container.find('.top').addClass('active');
                const bottomItem = container.find('.bottom').addClass('active');

                //avatar
                const avatarItem = container.find('.avatar');
                const oldBg = avatarItem.css('background-image');
                avatarItem.hover(() => {
                    avatarItem.css('background-image', avatarBg);
                }, () => {
                    avatarItem.css('background-image', oldBg);
                });

                //repo-name
                const nameItem = container.find('.name').html(name);

                //description
                const descriptionItem = container.find('.description').html(description);

                //stars
                const starItem = container.find('.star>.val').html(stars);

                //forks
                const forkItem = container.find('.fork>.val').html(forks);

                //date
                const formatDate = update.replace(/T.+/g, '');
                const dateItem = container.find('.date>.val').html(formatDate);
            });

            function _loadAvatar(url) {
                return new Promise((resolve, reject) => {
                    const img = new Image();
                    img.onload = () => {
                        resolve(url);
                    };
                    img.src = url;
                });
            }

        }

    })();
</script>





<script type="text/javascript" src="/js/plugins/local_search.js?v=1.4.0"></script>
<script type="text/javascript">
	var search_path = "search.xml";
	if (search_path.length === 0) {
		search_path = "search.xml";
	}
	var path = "/" + search_path;
	searchFunc(path, "local-search-input", "local-search-result");
</script>



<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>



    
        <script type="text/javascript" src="https://cdn1.lncld.net/static/js/3.0.4/av-min.js"></script>
<script type="text/javascript" src="//unpkg.com/valine/dist/Valine.min.js"></script>
<script type="text/javascript" src="/js/plugins/valine.js?v=1.4.0"></script>
    
    



<script type="text/javascript" src="https://cdn1.lncld.net/static/js/av-core-mini-0.6.4.js"></script>
<script type="text/javascript" src="/js/plugins/leancloud_visitors.js?v=1.4.0"></script>



    <!-- mathjax config similar to math.stackexchange -->
<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        tex2jax: {
            inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
            processEscapes: true,
            skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
        }
    });
</script>

<script type="text/x-mathjax-config">
    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for (i=0; i < all.length; i += 1) {
            all[i].SourceElement().parentNode.className += ' has-jax';
        }
    });
</script>

<script type="text/javascript" src="//cdn.bootcss.com/mathjax/2.7.1/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>




    <script>
    (function() {
        var OriginTitile = document.title, titleTime;
        document.addEventListener('visibilitychange', function() {
            if (document.hidden) {
                document.title = '我想你了！';
                clearTimeout(titleTime);
            } else {
                document.title = '(つェ⊂)咦!又好了!';
                titleTime = setTimeout(function() {
                    document.title = OriginTitile;
                },2000);
            }
        });
    })();
</script>






    <!-- Matomo -->
<script type="text/javascript">
  var _paq = window._paq || [];
  /* tracker methods like "setCustomDimension" should be called before "trackPageView" */
  _paq.push(['trackPageView']);
  _paq.push(['enableLinkTracking']);
  (function() {
    var u="//view.ourfor.top/";
    _paq.push(['setTrackerUrl', u+'matomo.php']);
    _paq.push(['setSiteId', '2']);
    var d=document, g=d.createElement('script'), s=d.getElementsByTagName('script')[0];
    g.type='text/javascript'; g.async=true; g.defer=true; g.src=u+'matomo.js'; s.parentNode.insertBefore(g,s);
  })();
</script>
<!-- End Matomo Code -->

    <script type="text/javascript" src="/js/earth.js"></script>
<script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"debug":false,"model":{"jsonPath":"/live2dw/assets/koharu.model.json"},"display":{"position":"right","width":150,"height":200},"mobile":{"show":false},"log":false});</script></body>
</html>
